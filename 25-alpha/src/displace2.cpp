//$Id: displace2.cpp 3127 2013-12-05 22:40:36Z jsibert $
#include "par_t.h"
#include "recap_t.h"
#include "prnstrem.h"
#include "trace.h"
#include <sstream>


//#include <strstream>
//using std::ostrstream;
//#define PENDL endl;
extern ofstream clogf;

// observed displacements from recapture file
// used in tac
void displacement_frequency(recaptype_vector& recaps, int nrecaps, par_t<d3_array,dmatrix,dvector,double>& param,
                            dmatrix& displacements, 
                            dmatrix& xdisp, dmatrix& ydisp, 
                            const dmatrix& distances, const dvector& bins)
{
  int b1 = bins.indexmin();
  int b2 = bins.indexmax();
  TTRACE(b1,b2)
  TTRACE(displacements.indexmin(),displacements.indexmax())
  TTRACE(displacements.rowmin(),displacements.rowmax())
  displacements.initialize();
  xdisp.initialize();
  ydisp.initialize();
  //int kmax = displacements(0).indexmax();
  int nrelease = param.get_nrelease();
  int max_month = displacements.rowmax();
  TRACE(max_month)
  //int month = 0;
  for (int kc = 1; kc <= nrecaps; kc++)
  {
     int cohort = recaps[kc].cohort;
     int i = recaps[kc].i;
     int j = recaps[kc].j;
     int cc = 1;
     for (; cc <= nrelease; cc++)
     {
       if (cohort == param.get_tr_cohort(cc))
       {
         break;
       }
     }
     int tal = recaps[kc].date - param.get_tr_date(cc);
        if (tal < 0)
        {
          clogf << "!! recapture " << kc << " on " <<recaps[kc].date
                << " seems to have occured before the release of cohort "
                << cc << " on " <<  param.get_tr_date(cc) << endl;
          clogf << "!! tal set to zero" << endl;
	  tal = 0;
        }

     if (tal > max_month)
     {
       tal = max_month;
     }
     int irel = param.get_tr_i(cc);
     int jrel = param.get_tr_j(cc);
     int ii = i-irel;
     int jj = j-jrel;
     xdisp(tal,ii) += recaps[kc].returns;
     ydisp(tal,jj) += recaps[kc].returns;

     ii = abs(ii);
     jj = abs(jj);

     if (distances(ii,jj) >= bins(b2))
     {
       TTRACE(tal,b2)
       displacements(tal,b2) += recaps[kc].returns; 
     }
     else
     {
       for (int b = b1; b < b2; b++)
       {
         if (distances(ii,jj) <= bins(b))
         {
            int bb = b;
            if (bb >  displacements.indexmax())
            {
              bb =  displacements.indexmax();
              TTRACE(b,bb)
            }

            displacements(tal,bb) += recaps[kc].returns; 
            break;
         }
       }
     } 
  }
}

// diplacements of non-recaptured tags at liberty
// used in tagmove simulator
void displacement_frequency(const int cohort, const dmatrix& tags, 
                        dvector& displacements, dvector& xdisp, dvector& ydisp, 
                        const dmatrix& distances, const dvector& bins, 
                        par_t<d3_array,dmatrix,dvector,double>& param)
{
  int irel = param.get_tr_i(cohort);
  int jrel = param.get_tr_j(cohort);

  int b1 = bins.indexmin();
  int b2 = bins.indexmax();

  int i1 = tags.rowmin();
  int i2 = tags.rowmax();
  for (int i = i1; i <= i2; i++)
  {
    int j1 = tags(i).indexmin();
    int j2 = tags(i).indexmax();
    for (int j = j1; j <= j2; j++)
    {
      int ii = i-irel;
      xdisp(ii) += tags(i,j);
      int jj = j-jrel;
      ydisp(jj) += tags(i,j);

      ii = abs(ii);
      jj = abs(jj);
 
      if (distances(ii,jj) >= bins(b2))
      {
        displacements(b2) += tags(i,j);
      }
      else
      {
        for (int b = b1; b < b2; b++)
        {
          if (distances(ii,jj) <= bins(b))
          {
             displacements(b) += tags(i,j);
             break;
          }
        }
      }
    }
  }
}


/*
movemod/21/diplacement_bins.r

> outer(0:5,0:5,function(x,y)sqrt(x^2+y^2))
     [,1]     [,2]     [,3]     [,4]     [,5]     [,6]
[1,]    0 1.000000 2.000000 3.000000 4.000000 5.000000
[2,]    1 1.414214 2.236068 3.162278 4.123106 5.099020
[3,]    2 2.236068 2.828427 3.605551 4.472136 5.385165
[4,]    3 3.162278 3.605551 4.242641 5.000000 5.830952
[5,]    4 4.123106 4.472136 5.000000 5.656854 6.403124
[6,]    5 5.099020 5.385165 5.830952 6.403124 7.071068
> junk <- sort(unique(60*as.vector(outer(0:5,0:5,function(x,y)sqrt(x^2+y^2)))))
> junk
 [1]   0.00000  60.00000  84.85281 120.00000 134.16408 169.70563 180.00000
 [8] 189.73666 216.33308 240.00000 247.38634 254.55844 268.32816 300.00000
[15] 305.94117 323.10989 339.41125 349.85711 384.18745 424.26407
> .5*(junk[-1]+junk[-length(junk)])
 [1]  30.0000  72.4264 102.4264 127.0820 151.9349 174.8528 184.8683 203.0349
 [9] 228.1665 243.6932 250.9724 261.4433 284.1641 302.9706 314.5255 331.2606
[17] 344.6342 367.0223 404.2258
*/

dvector displacement_bins(par_t<d3_array,dmatrix,dvector,double>& param, dmatrix& distances)
{

  dvector gins("{0,60,84.85281,120,134.1641,169.7056,\
      180,189.7367,216.3331,240,247.3863,254.5584,\
      268.3282,300,305.9412,323.1099,339.4113,349.8571,\
      360,364.9658,379.4733,384.1875,402.4922,420,\
      424.2641,432.6662,436.8066,456.9464,468.615,480,\
      483.7355,494.7727,509.1169,512.6402,516.1395,536.6563,\
      540,543.3231,553.1727,566.0389,569.21,590.9315,\
      593.9697,600,602.9925,611.8823,617.7378,626.4184,\
      637.8087,646.2198,648.9992,660,662.7217,670.8204,\
      678.8225,684.1053,699.7142,702.282,720,722.4957,\
      724.9828,729.9315,732.3933,742.159,751.7978,758.9466,\
      763.6753,768.3749,780,782.3043,789.1768,800.4998,\
      804.9845,807.2174,816.0882,833.5466,835.7033,840,\
      842.1401,848.5281,852.7602,859.0693,865.3323,873.6132,\
      885.8894,891.9641,900,901.9978,907.9648,913.8928,\
      915.8603,917.8235,931.4505,933.381,937.23,939.1486,\
      948.6833,960,961.8732,967.4709,969.3297,976.7292,\
      984.0732,989.5454,993.1767,998.599,1005.783,1018.234,\
      1020,1021.763,1025.28,1027.035,1032.279,1035.761,\
      1047.855,1049.571,1061.508,1063.203,1068.27,1073.313,\
      1080,1081.665,1086.646,1094.897,1101.454,1103.087,\
      1106.345,1116.065,1120.893,1127.298,1132.078,1138.42,\
      1140,1141.578,1146.298,1152.562,1154.123,1158.792,\
      1164.989,1178.813,1181.863,1183.385,1187.939,1190.966,\
      1195.492,1200,1201.499,1205.985,1207.477,1213.425,\
      1214.907,1223.765,1231.097,1235.476,1236.932,1248.519,\
      1252.837,1260,1261.428,1265.701,1271.377,1272.792,\
      1275.617,1282.653,1284.056,1288.255,1292.44,1295.222,\
      1297.998,1310.42,1315.903,1317.27,1320,1321.363,\
      1325.443,1328.157,1332.216,1341.641,1348.332,1353.662,\
      1357.645,1360.294,1368.211,1369.525,1370.839,1380,\
      1381.304,1385.208,1391.69,1395.564,1399.428,1400.714,\
      1404.564,1405.845,1412.232,1416.051,1422.392,1426.184,\
      1431.223,1440,1441.249,1442.498,1444.991,1449.966,\
      1451.206,1452.446,1459.863,1461.095,1464.787,1470.918,\
      1475.805,1481.891,1484.318,1485.53,1490.369,1500,\
      1501.2,1503.596,1504.792,1510.761,1514.332,1517.893,\
      1519.079,1527.351,1529.706,1533.232,1536.75,1537.921,\
      1542.595,1548.419,1556.535,1557.691,1560,1561.153,\
      1564.609,1570.35,1574.929,1578.354,1584.045,1585.181,\
      1588.584,1594.24,1597.623,1601,1609.969,1612.203,\
      1614.435,1615.549,1620,1621.111,1624.438,1629.969,\
      1632.176,1637.681,1638.78,1647.544,1650.818,1655.174,\
      1659.518,1663.851,1667.093,1668.173,1671.407,1673.559,\
      1680,1681.071,1684.28,1689.615,1690.68,1693.871,\
      1697.056,1698.117,1699.176,1705.52,1706.576,1707.63,\
      1716.042,1718.139,1719.186,1727.542,1730.665,1731.704,\
      1740,1741.034,1744.133,1747.226,1749.286,1752.37,\
      1756.474,1764.653,1765.673,1771.779,1772.794,1776.851,\
      1780.899,1781.909,1783.928,1789.972,1797.999,1800,\
      1801,1803.996,1804.993,1808.978,1813.946,1815.93,\
      1821.867,1824.829,1827.786,1828.77,1831.721,1835.647,\
      1836.627,1840.543,1848.351,1852.242,1853.213,1860,\
      1860.967,1862.901,1863.867,1866.762,1868.689,1874.46,\
      1875.42,1878.297,1879.255,1883.083,1884.038,1894.518,\
      1897.367,1905.886,1906.83,1909.66,1913.426,1914.367,\
      1917.185,1920,1920.937,1923.746,1928.419,1932.149,\
      1934.942,1936.801,1938.659,1943.296,1946.998,1951.615,\
      1953.458,1954.38,1958.979,1961.734,1965.401,1968.146,\
      1973.626,1979.091,1980,1980.909,1983.633,1986.353,\
      1987.259,1988.165,1994.492,1997.198,1998.099,2002.598,\
      2005.293,2011.567,2012.461,2016.036,2016.928,2024.055,\
      2030.271,2036.468,2037.351,2038.235,2040,2040.882,\
      2043.526,2047.926,2050.561,2052.316,2054.069,2061.941,\
      2064.558,2066.301,2068.913,2071.521,2072.39,2079.327,\
      2080.192,2082.787,2087.103,2089.689,2093.132,2095.71,\
      2099.143,2100,2100.857,2103.426,2106.846,2107.7,\
      2110.261,2113.67,2120.472,2121.32,2123.017,2126.405,\
      2128.098,2130.634,2136.539,2141.588,2144.108,2146.625,\
      2148.302,2150.814,2154.159,2160,2160.833,2163.331,\
      2164.163,2167.487,2168.317,2173.292,2174.121,2174.948,\
      2180.734,2181.559,2184.033,2189.795,2197.18,2200.454,\
      2201.272,2202.907,2206.173,2207.804,2212.691,2213.504,\
      2220,2220.811,2223.241,2226.477,2227.285,2229.709,\
      2232.129,2232.935,2240.179,2241.785,2246.597,2249,\
      2252.199,2254.595,2255.394,2258.584,2259.38,2261.769,\
      2264.155,2268.127,2271.299,2276.84,2280,2280.789,\
      2283.156,2284.732,2287.094,2291.026,2292.597,2296.519,\
      2297.303,2299.652,2305.125,2308.246,2309.026,2315.254,\
      2316.031,2317.585,2318.361,2329.979,2333.838,2334.609,\
      2336.921,2340,2340.769,2343.075,2346.913,2352.275,\
      2353.041,2357.626,2359.152,2361.44,2363.726,2364.487,\
      2366.77,2367.53,2373.605,2375.879,2377.394,2379.664,\
      2381.932,2388.724,2389.477,2390.983,2395.496,2397.749,\
      2400,2400.75,2401.5,2402.998,2406.741,2409.73,\
      2411.97,2413.462,2414.953,2415.699,2418.677,2421.652,\
      2426.85,2427.591,2429.815,2431.296,2436.473,2442.376,\
      2443.113,2447.529,2448.265,2449,2451.204,2460,\
      2460.732,2462.194,2462.925,2466.577,2468.765,2470.951,\
      2471.68,2473.863,2478.225,2480.403,2484.029,2486.202,\
      2489.096,2495.596,2497.038,2497.759,2500.64,2503.518,\
      2505.674,2506.392,2507.11,2512.131,2512.847,2518.571,\
      2520,2520.714,2522.856,2523.569,2526.42,2529.269,\
      2531.403,2532.114,2537.794,2542.754,2545.584,2546.291,\
      2546.998,2549.117,2551.235,2552.646,2554.76,2558.281,\
      2563.201,2565.307,2568.112,2576.509,2577.208,2580,\
      2580.698,2582.789,2584.879,2586.271,2588.359,2590.444,\
      2591.139,2595.997,2596.69,2597.383,2599.461,2602.921,\
      2604.995,2607.758,2613.963,2616.028,2619.466,2620.84,\
      2624.271,2629.753,2630.437,2631.805,2634.54,2635.906,\
      2637.954,2640,2640.682,2642.726,2646.129,2648.849,\
      2650.887,2652.244,2656.313,2656.991,2657.668,2663.081,\
      2664.432,2665.108,2673.2,2675.892,2678.582,2679.254,\
      2681.268,2683.282,2686.634,2689.312,2694.661,2695.329,\
      2696.665,2700,2700.667,2702.665,2705.993,2707.323,\
      2710.646,2711.31,2713.301,2715.29,2716.616,2718.603,\
      2720.588,2721.25,2723.894,2727.196,2729.176,2732.471,\
      2736.421,2737.079,2739.051,2741.678,2742.335,2747.581,\
      2748.236,2752.817,2753.471,2758.043,2760,2760.652,\
      2762.607,2763.91,2765.863,2768.465,2770.415,2773.662,\
      2774.311,2776.256,2779.496,2783.379,2784.026,2789.193,\
      2791.129,2791.774,2794.351,2796.927,2798.857,2800.143,\
      2801.428,2805.281,2809.128,2810.409,2811.69,2812.33,\
      2817.446,2820,2820.638,2822.552,2824.465,2825.739,\
      2827.649,2830.194,2832.102,2835.913,2837.816,2842.886,\
      2844.785,2845.417,2846.05,2850.474,2851.105,2852.367,\
      2858.041,2860.559,2862.447,2865.589,2868.1,2871.237,\
      2873.117,2875.622,2880,2880.625,2881.25,2882.499,\
      2883.123,2884.996,2885.62,2886.243,2889.983,2895.583,\
      2896.204,2898.068,2899.931,2902.413,2903.033,2904.892,\
      2907.989,2910.464,2912.937,2916.025,2919.726,2922.191,\
      2925.269,2925.884,2927.729,2929.573,2930.188,2930.802,\
      2932.644,2935.098,2940,2940.612,2941.836,2942.448,\
      2945.505,2949.78,2951.61,2952.22,2954.657,2955.266,\
      2960.135,2961.959,2963.781,2964.389,2968.636,2969.848,\
      2971.06,2974.693,2978.926,2979.53,2980.738,2983.756,\
      2984.359,2986.168,2989.18,2995.797,2998.8,3000,\
      3000.6,3002.399,3005.395,3007.191,3009.585,3012.574,\
      3013.171,3014.963,3017.35,3019.735,3021.523,3026.88,\
      3028.663,3029.257,3032.227,3034.007,3035.787,3036.379,\
      3038.157,3041.71,3046.441,3048.213,3054.701,3055.29,\
      3055.88,3057.646,3059.412,3060,3060.588,3062.352,\
      3064.702,3065.29,3066.464,3069.397,3071.742,3073.5,\
      3074.671,3075.841,3078.766,3081.104,3084.023,3085.19,\
      3085.774,3088.689,3092.766,3096.837,3097.418,3099.742,\
      3104.384,3107.282,3111.334,3111.913,3113.069,3113.647,\
      3115.381,3118.269,3120,3120.577,3122.307,3125.188,\
      3129.217,3130.367,3132.092,3134.39,3139.554,3140.701,\
      3141.274,3143.565,3144.137,3145.854,3148.142,3148.714,\
      3149.857,3153.284,3156.707,3157.847,3161.835,3166.386,\
      3168.091,3168.659,3170.363,3173.2,3175.468,3177.169,\
      3180,3180.566,3182.263,3184.525,3185.09,3188.479,\
      3189.044,3189.608,3193.556,3194.12,3195.246,3195.81,\
      3198.625,3200.312,3201.999,3204.809,3207.055,3207.616,\
      3209.299,3212.102,3216.022,3219.938,3222.732,3224.407,\
      3225.523,3228.87,3229.427,3231.099,3234.44,3236.109,\
      3240,3240.556,3242.221,3244.996,3247.214,3247.768,\
      3248.877,3252.199,3253.859,3259.939,3260.491,3262.698,\
      3264.353,3265.456,3267.109,3269.312,3273.713,3274.263,\
      3275.363,3277.56,3278.658,3280.305,3282.499,3284.692,\
      3286.883,3289.073,3295.087,3300,3300.545,3301.636,\
      3302.181,3304.361,3304.905,3306.539,3308.716,3309.26,\
      3310.347,3313.065,3313.608,3319.036,3319.578,3321.747,\
      3326.62,3327.702,3328.243,3332.567,3334.187,3334.726,\
      3336.345,3339.581,3342.813,3343.89,3345.504,3347.118,\
      3348.194,3351.955,3354.102,3356.784,3358.392,3360,\
      3360.536,3362.142,3362.678,3364.818,3365.353,3368.561,\
      3373.366,3377.632,3378.165,3379.231,3381.361,3381.893,\
      3384.021,3386.148,3387.743,3390.929,3394.113,3395.173,\
      3396.233,3396.763,3398.353,3398.882,3403.116,3403.645,\
      3405.231,3407.873,3409.457,3411.041,3411.569,3413.151,\
      3415.26,3416.314,3420,3420.526,3422.105,3424.208,\
      3424.734,3428.411,3432.084,3433.133,3434.705,3436.277,\
      3436.801,3438.372,3438.895,3443.08,3445.693,3447.26,\
      3449.348,3453.52,3454.041,3455.083,3457.687,3461.329,\
      3461.849,3462.369,3463.409,3466.526,3468.083,3472.233,\
      3476.377,3478.448,3478.965,3480,3480.517,3482.068,\
      3483.102,3484.652,3488.266,3490.845,3491.361,3492.907,\
      3494.453,3494.968,3495.483,3498.571,3504.74,3505.253,\
      3507.82,3511.41,3512.947,3515.508,3516.02,3520.114,\
      3521.647,3523.691,3527.776,3529.306,3529.816,3531.345,\
      3532.365,3533.893,3536.439,3540,3540.508,3542.033,\
      3543.558,3544.573,3545.589,3548.126,3550.155,3552.182,\
      3552.689,3553.702,3554.209,3558.258,3561.797,3563.818,\
      3564.323,3564.828,3566.343,3567.856,3568.865,3570.378,\
      3572.394,3572.898,3576.926,3578.435,3579.944,3580.95,\
      3586.475,3588.482,3588.983,3590.487,3594.496,3595.998,\
      3596.498,3600,3600.5,3601,3601.999,3604.497,\
      3604.997,3606.494,3607.991,3608.49,3609.986,3612.478,\
      3612.977,3617.955,3618.453,3622.43,3624.417,3624.914,\
      3626.403,3627.892,3631.859,3632.355,3636.317,3638.296,\
      3640.275,3643.734,3644.722,3648.178,3648.671,3649.658,\
      3650.151,3652.616,3654.094,3655.571,3657.54,3660,\
      3660.492,3661.967,3663.441,3664.424,3665.897,3667.86,\
      3671.294,3672.274,3673.255,3676.194,3677.662,3679.62,\
      3681.087,3683.531,3684.02,3687.926,3691.341,3693.291,\
      3695.24,3696.701,3697.188,3699.622,3701.081,3703.026,\
      3704.484,3706.427,3708.854,3710.795,3711.28,3714.674,\
      3719.032,3720,3720.484,3721.935,3724.352,3725.802,\
      3727.734,3730.147,3730.63,3732.077,3733.524,3734.488,\
      3735.934,3737.379,3737.86,3741.711,3742.192,3743.635,\
      3745.557,3746.038,3748.92,3750.84,3755.156,3756.594,\
      3757.552,3758.51,3758.989,3760.904,3766.165,3768.076,\
      3769.032,3776.189,3778.095,3780,3780.476,3781.904,\
      3783.808,3784.283,3787.611,3788.087,3789.037,3789.512,\
      3791.886,3794.733,3795.208,3797.104,3799.474,3800.895,\
      3803.262,3804.681,3810.354,3810.827,3811.771,3813.66,\
      3814.132,3816.019,3817.905,3818.377,3819.319,3821.675,\
      3822.146,3826.852,3827.323,3828.733,3829.204,3833.432,\
      3834.371,3837.186,3838.593,3840,3840.469,3841.875,\
      3844.216,3844.685,3847.493,3847.96,3848.428,3851.701,\
      3852.168,3855.438,3856.838,3857.305,3859.637,3861.036,\
      3862.9,3864.298,3864.764,3866.626,3868.488,3869.884,\
      3870.814,3872.209,3873.603,3877.319,3877.783,3878.247,\
      3879.639,3885.666,3886.592,3888.907,3890.758,3893.071,\
      3893.995,3896.306,3900,3900.462,3901.846,3903.229,\
      3904.152,3906.917,3907.378,3908.759,3911.521,3912.902,\
      3915.201,3916.58,3917.959,3918.418,3922.091,3922.55,\
      3923.468,3926.22,3927.595,3929.427,3930.801,3931.259,\
      3933.09,3936.293,3937.207,3944.059,3944.515,3945.884,\
      3947.252,3947.708,3948.164,3951.354,3951.81,3955.452,\
      3956.817,3958.181,3960,3960.455,3961.818,3962.272,\
      3964.089,3965.905,3967.266,3967.72,3971.347,3972.707,\
      3973.16,3974.519,3976.33,3977.235,3978.593,3982.21,\
      3984.018,3984.47,3988.082,3988.985,3989.436,3991.691,\
      3994.396,3996.198,3996.649,3998.45,3998.9,4002.499,\
      4003.848,4005.197,4005.646,4010.586,4011.035,4013.278,\
      4014.623,4016.416,4020,4020.448,4021.791,4023.133,\
      4024.028,4024.922,4027.158,4030.732,4031.178,4032.071,\
      4032.518,4033.857,4036.087,4041.435,4041.881,4044.997,\
      4045.442,4046.776,4048.111,4048.555,4052.111,4052.555,\
      4056.107,4057.438,4060.542,4060.985,4063.201,4064.529,\
      4066.743,4068.071,4072.935,4073.819,4074.702,4076.469,\
      4077.352,4078.676,4080,4080.441,4080.882,4081.764,\
      4083.969,4085.731,4087.053,4089.254,4091.015,4094.533,\
      4094.973,4095.852,4098.488,4101.122,4101.561,4104.632,\
      4105.508,4106.824,4108.138,4108.576,4110.328,4112.517,\
      4115.58,4116.017,4117.329,4119.515,4120.825,4122.572,\
      4123.882,4126.063,4127.808,4129.116,4132.602,4133.038,\
      4136.52,4136.955,4137.826,4140,4140.435,4141.739,\
      4143.042,4143.911,4144.78,4146.951,4147.385,4150.855,\
      4152.156,4153.89,4155.623,4157.355,4157.788,4158.654,\
      4159.086,4160.385,4161.25,4162.547,4164.277,4165.573,\
      4167.733,4171.618,4174.207,4175.069,4178.086,4178.516,\
      4179.378,4183.252,4186.263,4186.693,4188.842,4190.131,\
      4191.42,4192.279,4193.567,4195.283,4198.285,4200,\
      4200.429,4201.714,4202.142,4203.855,4205.568,4206.852,\
      4210.701,4212.838,4213.692,4214.119,4215.4,4215.827,\
      4217.535,4219.668,4220.521,4220.948,4223.079,4224.358,\
      4226.062,4227.34,4229.468,4231.17,4234.572,4236.272,\
      4236.697,4239.67,4240.943,4242.641,4243.489,4246.033,\
      4246.457,4248.153,4249.847,4250.271,4251.541,4252.811,\
      4256.195,4260,4260.423,4261.267,4261.69,4263.801,\
      4266.755,4267.177,4270.129,4270.55,4271.815,4273.079,\
      4275.184,4276.868,4278.551,4280.654,4283.176,4284.017,\
      4285.277,4286.957,4288.216,4290.315,4290.734,4293.251,\
      4293.67,4294.089,4295.346,4296.603,4301.628,4302.046,\
      4307.064,4308.318,4310.406,4310.824,4312.076,4320,\
      4320.417,4320.833,4321.666,4322.083,4323.748,4324.165,\
      4325.413,4326.662,4327.494,4328.325,4330.404,4330.82,\
      4332.066,4334.144,4334.974,4336.635,4340.369,4340.783,\
      4342.027,4344.099,4345.342,4346.585,4346.999,4348.241,\
      4349.897,4351.965,4353.619,4354.033,4356.926,4357.339,\
      4360.229,4361.468,4363.118,4363.943,4366.83,4368.066,\
      4370.126,4371.773,4373.831,4375.066,4376.711,4379.589,\
      4380,4380.411,4381.644,4383.286,4383.697,4384.929,\
      4386.57,4389.852,4390.262,4394.36,4394.77,4400.091,\
      4400.909,4401.318,4402.545,4403.362,4404.589,4405.814,\
      4406.223,4409.898,4412.346,4412.754,4413.162,4414.386,\
      4415.609,4416.016,4419.683,4420.905,4424.161,4425.381,\
      4425.788,4427.008,4427.415,4429.041,4429.447,4432.697,\
      4435.538,4438.784,4440,4440.405,4441.621,4442.432,\
      4443.647,4445.672,4446.482,4448.91,4450.124,4452.146,\
      4452.954,4454.571,4454.975,4456.591,4458.206,4459.417,\
      4459.821,4464.258,4464.661,4465.871,4467.885,4471.107,\
      4471.51,4472.717,4477.544,4477.946,4479.152,4480.357,\
      4481.161,4482.365,4483.57,4483.971,4487.583,4488.786,\
      4490.791,4493.195,4496.799,4497.199,4498,4500,\
      4500.4,4501.6,4503.599,4504.398,4506.395,4507.993,\
      4509.191,4509.989,4510.787,4511.186,4512.782,4514.377,\
      4516.37,4517.167,4517.566,4518.761,4519.558,4523.538,\
      4525.528,4525.925,4527.118,4528.311,4530.298,4532.284,\
      4535.063,4535.46,4536.254,4536.651,4538.634,4539.824,\
      4541.409,4542.598,4542.995,4544.579,4546.163,4548.142,\
      4549.33,4553.68,4555.656,4557.236,4557.631,4560,\
      4560.395,4561.579,4563.551,4566.311,4567.1,4569.464,\
      4569.858,4573.008,4574.188,4574.582,4576.549,4577.729,\
      4579.301,4582.052,4582.838,4584.016,4585.194,4588.725,\
      4589.118,4591.862,4592.254,4593.038,4593.43,4594.606,\
      4596.564,4599.304,4599.696,4601.261,4601.652,4607.516,\
      4610.249,4610.64,4611.03,4613.762,4614.152,4615.322,\
      4616.492,4618.052,4620,4620.39,4621.558,4623.505,\
      4624.673,4626.23,4627.786,4629.341,4629.73,4630.508,\
      4632.062,4634.005,4635.17,4636.723,4639.052,4640.216,\
      4642.155,4643.318,4644.868,4645.256,4647.967,4648.355,\
      4649.516,4651.451,4657.252,4658.798,4659.957,4661.888,\
      4666.905,4667.676,4668.062,4669.218,4669.604,4669.989,\
      4672.687,4673.072,4673.842,4675.767,4676.152,4679.231,\
      4680,4680.385,4681.538,4681.923,4683.46,4685.382,\
      4686.15,4686.534,4689.606,4691.141,4693.826,4694.209,\
      4694.593,4695.743,4697.659,4698.808,4700.34,4703.403,\
      4704.551,4706.081,4706.846,4709.522,4711.051,4712.961,\
      4714.106,4715.252,4716.015,4718.305,4718.686,4722.88,\
      4723.262,4724.786,4726.309,4727.452,4728.975,4730.877,\
      4731.258,4732.399,4733.54,4735.061,4735.441,4740,\
      4740.38,4741.519,4743.416,4744.555,4746.072,4747.21,\
      4749.484,4750.621,4751.758,4752.136,4752.515,4753.651,\
      4754.787,4755.544,4758.571,4759.328,4762.73,4763.864,\
      4764.242,4765.753,4768.773,4770.66,4773.301,4776.317,\
      4776.693,4777.447,4777.824,4778.954,4781.966,4782.343,\
      4782.719,4785.353,4785.729,4788.737,4789.864,4790.992,\
      4792.87,4794.372,4795.498,4795.873,4798.875,4800,\
      4800.375,4801.5,4802.999,4803.374,4803.749,4804.873,\
      4805.996,4806.745,4807.869,4809.366,4812.733,4813.481,\
      4813.855,4815.724,4816.845,4818.34,4819.461,4821.701,\
      4823.94,4824.687,4825.806,4826.924,4827.297,4829.907,\
      4830.279,4831.397,4831.77,4836.238,4836.61,4837.355,\
      4839.215,4839.587,4842.561,4843.305,4845.163,4846.648,\
      4848.134,4848.505,4853.7,4855.183,4857.036,4857.407,\
      4859.63,4860,4860.37,4861.481,4862.592,4862.962,\
      4863.332,4865.922,4867.402,4869.25,4872.946,4873.315,\
      4875.162,4876.269,4878.114,4879.221,4880.697,4883.646,\
      4884.015,4884.752,4886.226,4888.067,4889.54,4889.908,\
      4892.484,4893.955,4895.059,4895.794,4896.529,4896.897,\
      4898,4901.306,4902.408,4904.61,4907.178,4910.112,\
      4910.479,4911.578,4913.044,4914.509,4915.974,4916.34,\
      4919.268,4920,4920.366,4921.463,4922.195,4923.292,\
      4924.388,4924.754,4925.85,4928.042,4929.138,4932.058,\
      4933.153,4933.518,4936.801,4937.53,4937.894,4939.717,\
      4940.81,4941.902,4942.631,4943.359,4945.179,4947.727,\
      4949.545,4952.454,4953.908,4956.45,4957.177,4958.266,\
      4959.718,4960.806,4962.62,4964.071,4965.521,4965.884,\
      4968.058,4968.42,4971.318,4971.68,4972.404,4972.766,\
      4975.661,4978.192,4978.554,4980,4980.361,4981.446,\
      4983.252,4985.78,4989.028,4990.11,4991.192,4991.553,\
      4991.913,4992.995,4994.076,4994.437,4995.518,4997.679,\
      5001.28,5001.64,5003.079,5004.518,5005.956,5006.316,\
      5007.035,5009.192,5011.347,5011.706,5012.784,5014.22,\
      5016.014,5017.808,5018.884,5020.319,5020.677,5023.545,\
      5024.261,5024.619,5025.694,5026.41,5028.916,5031.779,\
      5032.137,5036.07,5037.142,5040,5040.357,5040.714,\
      5041.428,5043.213,5043.57,5044.641,5045.711,5047.138,\
      5048.921,5049.277,5050.347,5052.128,5052.841,5053.197,\
      5057.47,5058.537,5058.893,5060.672,5062.806,5063.161,\
      5064.227,5066.004,5068.846,5070.266,5071.686,5072.041,\
      5074.879,5075.589,5075.943,5077.716,5078.779,5081.614,\
      5083.031,5083.385,5085.509,5086.217,5088.693,5091.169,\
      5091.876,5092.583,5093.996,5094.35,5095.763,5097.529,\
      5098.235,5100,5100.353,5101.412,5102.47,5103.175,\
      5104.234,5105.291,5105.644,5108.816,5109.521,5109.873,\
      5112.69,5114.098,5116.561,5117.265,5119.727,5122.538,\
      5122.89,5125.349,5125.7,5126.402,5126.753,5128.509,\
      5129.561,5130.614,5133.771,5135.173,5136.224,5136.925,\
      5137.976,5142.179,5142.529,5143.579,5145.328,5147.776,\
      5148.126,5150.573,5151.97,5153.019,5154.416,5154.765,\
      5157.558,5158.953,5159.302,5160,5160.349,5161.395,\
      5162.093,5163.139,5165.578,5167.32,5167.669,5168.714,\
      5169.758,5172.543,5172.891,5176.022,5176.717,5177.065,\
      5178.803,5179.846,5180.888,5181.235,5182.277,5182.625,\
      5184.014,5184.361,5187.138,5188.179,5189.566,5191.994,\
      5192.341,5193.38,5194.767,5195.113,5196.499,5198.923,\
      5201,5202.038,5203.768,5205.843,5206.189,5208.954,\
      5209.299,5209.99,5210.336,5213.099,5215.515,5217.241,\
      5218.621,5220,5220.345,5221.379,5222.758,5223.103,\
      5225.514,5225.859,5226.892,5227.925,5228.614,5232.055,\
      5232.399,5234.119,5236.869,5237.9,5238.931,5239.275,\
      5241.679,5242.023,5245.112,5247.514,5247.857,5248.543,\
      5253.342,5254.37,5255.74,5257.109,5258.479,5259.506,\
      5259.848,5260.874,5261.559,5262.585,5263.611,5267.03,\
      5268.055,5269.08,5269.421,5270.787,5271.812,5275.225,\
      5275.908,5277.954,5278.977,5280,5280.341,5281.363,\
      5283.067,5283.408,5284.43,5285.452,5286.133,5287.154,\
      5288.516,5291.578,5292.258,5293.959,5294.299,5295.319,\
      5296.678,5297.018,5297.698,5299.396,5301.773,5303.471,\
      5304.489,5304.828,5307.542,5308.898,5310.593,5311.61,\
      5312.626,5312.965,5313.982,5315.336,5316.014,5317.029,\
      5318.383,5318.722,5321.09,5323.796,5325.148,5326.162,\
      5328.865,5330.216,5330.553,5331.904,5333.254,5337.303,\
      5340,5340.337,5341.348,5342.696,5343.033,5344.043,\
      5345.391,5345.727,5346.401,5348.42,5349.43,5351.112,\
      5351.785,5352.121,5356.155,5356.491,5357.163,5358.507,\
      5359.179,5361.53,5362.537,5364.215,5366.563,5367.234,\
      5368.24,5369.581,5369.916,5372.262,5373.267,5373.602,\
      5375.277,5377.62,5378.624,5380.632,5381.635,5384.311,\
      5388.321,5388.655,5389.323,5389.657,5390.659,5392.328,\
      5393.329,5393.663,5393.997,5396.332,5396.666,5397.666,\
      5399.333,5400,5400.333,5401.333,5401.666,5402.999,\
      5404.665,5405.331,5405.664,5408.327,5411.987,5412.652,\
      5414.647,5414.979,5415.312,5416.309,5420.295,5421.291,\
      5422.619,5425.606,5426.601,5426.933,5428.259,5428.591,\
      5430.58,5431.243,5433.231,5436.212,5436.543,5437.205,\
      5440.184,5441.176,5441.838,5442.499,5444.153,5445.475,\
      5447.128,5447.789,5448.119,5449.44,5452.412,5454.393,\
      5455.053,5456.043,5457.362,5458.351,5460,5460.33,\
      5461.319,5462.966,5463.955,5464.943,5465.272,5465.602,\
      5468.236,5470.868,5471.855,5472.842,5473.171,5474.157,\
      5474.486,5475.801,5476.13,5477.116,5478.102,5481.058,\
      5483.357,5483.685,5484.013,5484.67,5484.998,5486.31,\
      5486.638,5488.934,5491.557,5492.868,5495.162,5495.489,\
      5496.472,5499.745,5500.727,5502.363,5505.633,5506.941,\
      5507.268,5508.575,5509.882,5510.209,5515.433,5516.086,\
      5518.043,5519.022,5520,5520.326,5521.304,5521.63,\
      5522.934,5524.238,5525.215,5525.866,5526.844,5527.821,\
      5528.146,5530.75,5531.727,5532.052,5533.679,5535.955,\
      5536.931,5538.556,5538.881,5540.83,5541.48,5543.753,\
      5545.052,5546.35,5546.675,5547.324,5548.621,5552.513,\
      5554.458,5555.43,5556.726,5557.05,5558.021,5558.993,\
      5559.317,5559.64,5561.906,5562.23,5563.201,5565.788,\
      5566.758,5567.082,5568.052,5570.96,5573.545,5574.836,\
      5577.419,5577.741,5578.387,5580,5580.323,5581.29,\
      5582.258,5582.902,5583.547,5585.159,5586.448,5588.059,\
      5588.703,5589.025,5590.313,5591.601,5592.888,5593.854,\
      5594.176,5595.784,5597.714,5598.035,5600.286,5600.607,\
      5600.928,5602.856,5603.499,5604.463,5606.068,5608.315,\
      5608.636,5609.599,5610.561,5611.203,5612.165,5613.448,\
      5616.013,5616.333,5617.295,5618.256,5618.897,5620.818,\
      5623.38,5624.66,5626.26,5626.58,5628.819,5631.696,\
      5634.252,5634.891,5635.211,5636.488,5637.766,5639.042,\
      5640,5640.319,5641.276,5641.915,5642.872,5644.147,\
      5645.104,5646.698,5647.973,5648.929,5649.248,5650.522,\
      5651.478,5652.115,5654.662,5655.298,5655.617,5658.162,\
      5660.389,5661.978,5662.296,5664.203,5664.839,5665.792,\
      5669.603,5670.873,5671.825,5672.46,5673.412,5674.681,\
      5675.632,5677.535,5678.486,5680.07,5682.288,5683.555,\
      5685.139,5685.772,5687.671,5688.62,5689.569,5689.886,\
      5690.835,5692.1,5692.416,5693.681,5695.261,5696.209,\
      5700,5700.316,5700.947,5701.263,5702.21,5702.841,\
      5704.735,5705.05,5707.574,5707.889,5711.357,5712.618,\
      5715.453,5716.083,5716.397,5717.657,5720.175,5720.489,\
      5721.119,5723.006,5724.893,5725.522,5726.465,5727.722,\
      5728.979,5730.55,5731.178,5731.492,5734.004,5735.259,\
      5736.201,5738.083,5740.279,5741.533,5742.473,5742.787,\
      5743.1,5745.294,5746.234,5746.547,5748.113,5749.052,\
      5751.243,5751.556,5752.808,5753.121,5754.059,5757.812,\
      5760,5760.312,5761.25,5761.562,5762.499,5762.812,\
      5764.998,5766.247,5767.807,5768.119,5769.055,5769.991,\
      5770.615,5771.239,5772.486,5772.798,5775.292,5775.604,\
      5778.097,5779.031,5779.965,5780.277,5783.079,5784.012,\
      5785.257,5785.568,5787.746,5790.544,5791.166,5792.409,\
      5793.962,5796.137,5796.447,5797.689,5798.931,5799.862,\
      5800.483,5801.414,5804.826,5806.066,5806.376,5807.926,\
      5809.785,5810.095,5810.404,5812.573,5812.882,5813.811,\
      5815.978,5816.287,5820,5820.309,5820.928,5821.237,\
      5822.783,5823.71,5824.946,5825.873,5827.418,5827.727,\
      5828.653,5829.889,5830.197,5831.123,5832.049,5834.826,\
      5835.135,5836.06,5837.602,5838.527,5839.452,5839.76,\
      5840.993,5844.382,5844.998,5847.153,5849.615,5849.923,\
      5850.538,5850.846,5851.769,5854.537,5854.844,5855.459,\
      5856.996,5857.303,5858.225,5859.147,5860.375,5861.604,\
      5863.139,5864.367,5864.674,5865.288,5868.049,5870.196,\
      5871.729,5872.035,5874.487,5876.632,5876.938,5879.082,\
      5879.388,5880,5880.306,5881.224,5881.836,5882.754,\
      5883.672,5884.896,5885.202,5886.731,5887.648,5889.177,\
      5891.01,5893.759,5894.065,5894.981,5896.202,5897.423,\
      5898.644,5899.559,5901.085,5902.305,5903.219,5904.439,\
      5904.744,5905.963,5908.401,5908.705,5909.315,5909.619,\
      5910.533,5915.708,5916.012,5916.925,5919.358,5920.27,\
      5920.878,5923.006,5923.918,5924.221,5925.74,5927.563,\
      5928.777,5930.295,5930.599,5931.509,5933.026,5933.936,\
      5937.272,5938.788,5939.697,5940,5940.303,5941.212,\
      5942.121,5942.424,5942.727,5944.847,5945.149,5947.571,\
      5948.479,5949.387,5949.689,5950.899,5952.109,5954.83,\
      5956.946,5957.852,5959.06,5959.362,5959.664,5961.476,\
      5961.778,5962.08,5964.193,5964.495,5967.512,5967.814,\
      5968.718,5969.322,5970.226,5972.336,5974.144,5976.554,\
      5977.458,5978.361,5978.662,5981.371,5982.274,5983.477,\
      5983.778,5984.68,5985.883,5988.589,5989.491,5990.993,\
      5991.594,5991.895,5994.297,5995.498,5995.799,5997.6,\
      5999.1,6000,6000.3,6001.2,6002.699,6004.798,\
      6005.398,6007.495,6007.795,6010.191,6010.79,6011.09,\
      6012.587,6013.485,6014.383,6014.682,6015.879,6017.076,\
      6018.272,6019.169,6020.664,6024.251,6024.55,6025.147,\
      6025.446,6026.342,6026.94,6027.835,6029.925,6034.103,\
      6034.7,6036.191,6037.384,6038.874,6039.47,6039.768,\
      6041.258,6042.152,6043.046,6043.343,6046.023,6048.107,\
      6048.405,6050.488,6050.785,6052.867,6053.759,6054.056,\
      6057.326,6057.623,6058.515,6060,6061.188,6062.673,\
      6064.454,6064.751,6067.125,6068.015,6068.311,6070.684,\
      6071.573,6072.166,6072.759,6074.241,6074.537,6075.426,\
      6076.315,6078.98,6081.349,6083.42,6084.012,6084.899,\
      6086.082,6090.813,6091.108,6091.995,6092.881,6093.177,\
      6095.539,6095.835,6096.425,6098.196,6099.082,6100.262,\
      6102.622,6106.161,6107.34,6109.403,6109.697,6109.992,\
      6110.581,6111.759,6112.054,6112.348,6114.704,6115.292,\
      6117.058,6117.941,6118.823,6120,6120.294,6122.646,\
      6124.116,6124.704,6124.998,6126.467,6128.523,6129.405,\
      6130.579,6130.873,6132.047,6132.928,6138.208,6139.088,\
      6140.554,6141.433,6143.484,6143.777,6144.949,6145.242,\
      6146.999,6147.585,6148.463,6149.341,6151.683,6151.975,\
      6153.146,6154.608,6155.485,6156.655,6156.947,6157.532,\
      6158.993,6161.623,6163.668,6167.171,6168.047,6169.506,\
      6170.381,6171.548,6173.006,6174.172,6175.63,6176.504,\
      6177.378,6180.291,6184.658,6185.532,6187.277,6189.604,\
      6190.477,6193.674,6193.965,6194.255,6194.837,6196.58,\
      6198.613,6198.903,6199.484,6201.226,6202.096,6203.547,\
      6204.418,6206.738,6207.898,6208.188,6208.768,6214.853,\
      6215.143,6216.012,6217.17,6222.668,6223.825,6224.404,\
      6225.271,6226.138,6226.428,6227.295,6228.74,6229.029,\
      6229.896,6230.762,6231.34,6232.207,6236.538,6236.826,\
      6237.98,6240,6240.288,6240.577,6241.154,6242.596,\
      6243.749,6246.055,6247.207,6248.36,6250.664,6252.104,\
      6252.967,6254.119,6256.708,6257.571,6258.434,6259.01,\
      6261.022,6261.31,6263.322,6264.184,6266.77,6269.067,\
      6272.798,6273.659,6277.388,6278.248,6279.108,6279.395,\
      6279.682,6280.541,6281.401,6281.688,6282.547,6284.266,\
      6285.125,6287.13,6288.275,6288.561,6290.85,6291.709,\
      6293.425,6295.427,6297.428,6299.714,6300,6300.286,\
      6305.712,6306.568,6307.139,6309.136,6311.418,6312.559,\
      6315.695,6318.259,6318.544,6320.538,6321.677,6322.816,\
      6323.67,6325.093,6325.377,6326.231,6328.507,6332.772,\
      6333.056,6335.33,6336.182,6337.318,6338.738,6340.726,\
      6341.009,6341.293,6342.145,6345.55,6348.102,6348.953,\
      6350.937,6353.487,6356.886,6359.434,6360,6360.283,\
      6361.132,6361.415,6362.547,6363.961,6364.527,6366.223,\
      6369.05,6370.463,6372.723,6373.006,6373.853,6375.265,\
      6376.959,6378.087,6379.781,6384.011,6384.293,6386.267,\
      6387.112,6388.239,6390.493,6390.775,6391.62,6391.901,\
      6393.027,6396.405,6397.249,6397.531,6400.062,6400.625,\
      6406.528,6406.809,6407.652,6409.618,6409.899,6411.022,\
      6413.267,6413.548,6415.793,6416.635,6417.757,6418.598,\
      6420.28,6421.121,6422.523,6423.364,6424.204,6424.484,\
      6429.246,6430.086,6431.205,6432.045,6437.919,6439.876,\
      6440.155,6441.273,6442.67,6444.905,6445.464,6446.86,\
      6448.814,6449.372,6451.046,6452.441,6453.836,6456.903,\
      6457.74,6458.854,6462.198,6462.755,6466.931,6467.21,\
      6468.045,6468.879,6469.436,6470.27,6473.886,6474.72,\
      6476.11,6480.278,6482.777,6484.443,6484.721,6489.992,\
      6491.379,6492.488,6493.597,6493.874,6494.428,6494.706,\
      6495.537,6498.03,6500.246,6502.461,6504.399,6507.165,\
      6507.718,6507.995,6513.524,6514.63,6516.011,6520.429,\
      6521.258,6522.362,6523.465,6524.845,6525.397,6527.051,\
      6528.706,6531.187,6533.667,6534.218,6534.493,6535.87,\
      6538.624,6540,6541.101,6542.477,6544.677,6547.427,\
      6547.702,6549.901,6550.725,6552.099,6553.472,6555.12,\
      6556.493,6557.317,6557.591,6560.61,6564.176,6564.998,\
      6568.836,6573.218,6574.04,6575.409,6576.23,6577.325,\
      6578.146,6579.514,6582.796,6586.35,6587.169,6588.535,\
      6590.175,6591.54,6592.632,6595.908,6599.182,6600,\
      6601.091,6601.363,6603.545,6604.362,6606.815,6608.177,\
      6608.722,6612.534,6615.527,6616.615,6618.519,6619.063,\
      6620.695,6623.141,6623.413,6625.315,6626.13,6627.217,\
      6627.76,6628.575,6629.661,6632.104,6636.174,6638.072,\
      6638.343,6640.512,6640.783,6645.119,6647.285,6648.097,\
      6653.24,6654.592,6655.404,6656.486,6658.919,6661.081,\
      6662.162,6662.432,6664.323,6667.563,6668.373,6671.881,\
      6672.691,6673.23,6675.118,6677.275,6678.353,6681.587,\
      6681.856,6683.741,6684.011,6684.819,6690.202,6690.471,\
      6691.009,6691.278,6696.387,6698.806,6699.881,6703.372,\
      6703.909,6705.52,6706.325,6708.204,6709.545,6709.814,\
      6711.959,6713.568,6716.785,6720.268,6722.678,6723.481,\
      6724.284,6729.636,6732.043,6735.251,6737.655,6739.792,\
      6741.662,6742.729,6744.865,6745.932,6746.733,6746.999,\
      6749.133,6750.467,6752.333,6756.33,6756.597,6756.863,\
      6758.728,6760.858,6761.923,6762.721,6766.181,6768.043,\
      6768.309,6772.297,6773.625,6773.891,6775.751,6780.265,\
      6781.062,6784.246,6788.225,6788.755,6789.551,6790.346,\
      6790.611,6792.466,6792.996,6793.526,6793.791,6795.116,\
      6796.705,6801.47,6802.264,6804.381,6806.497,6807.29,\
      6807.819,6812.048,6814.162,6816.011,6818.915,6822.082,\
      6823.137,6824.456,6828.675,6830.783,6831.047,6831.837,\
      6832.628,6833.945,6837.105,6839.474,6841.053,6841.316,\
      6842.368,6843.42,6846.576,6847.627,6852.095,6852.883,\
      6854.196,6856.821,6857.084,6860.233,6863.381,6864.168,\
      6868.624,6872.816,6873.078,6873.602,6875.173,6876.743,\
      6877.267,6877.79,6878.052,6881.453,6884.33,6886.16,\
      6888.512,6889.557,6891.386,6891.908,6894.52,6898.696,\
      6900,6906.258,6906.519,6907.3,6912.51,6914.854,\
      6915.374,6915.634,6916.676,6918.757,6921.878,6922.658,\
      6925.258,6926.038,6931.234,6936.166,6937.464,6939.798,\
      6940.576,6944.725,6945.761,6948.093,6953.014,6956.12,\
      6957.931,6958.448,6960,6961.034,6962.327,6962.586,\
      6966.204,6966.463,6970.854,6972.661,6974.984,6976.532,\
      6977.048,6983.237,6984.01,6989.936,6990.193,6990.966,\
      6996.37,6997.142,6999.714,7000.486,7001.514,7003.571,\
      7005.883,7006.654,7008.709,7009.479,7009.736,7010.763,\
      7015.896,7020.256,7022.051,7022.82,7024.101,7028.2,\
      7029.225,7032.041,7037.414,7039.46,7040.739,7042.784,\
      7043.295,7044.828,7046.616,7047.382,7050.957,7055.551,\
      7055.806,7056.826,7058.612,7059.632,7061.161,7067.786,\
      7068.041,7073.132,7073.387,7075.422,7080.254,7084.067,\
      7085.337,7086.353,7088.385,7089.147,7091.431,7093.462,\
      7093.716,7095.492,7100.563,7104.365,7105.885,7106.645,\
      7107.658,7113.733,7116.01,7121.826,7122.837,7123.595,\
      7127.636,7128.141,7128.646,7129.656,7130.919,7132.181,\
      7135.713,7138.992,7140.252,7141.008,7142.269,7145.796,\
      7152.091,7152.342,7156.116,7156.871,7159.888,7164.161,\
      7168.431,7170.188,7171.192,7172.447,7173.2,7176.211,\
      7177.214,7177.966,7180.223,7185.235,7188.491,7188.992,\
      7191.245,7198.25,7200,7206.247,7212.489,7212.988,\
      7214.485,7215.234,7216.98,7220.471,7222.216,7224.957,\
      7225.206,7225.953,7230.436,7236.159,7236.905,7240.387,\
      7244.363,7248.089,7252.806,7255.04,7255.784,7256.032,\
      7258.016,7260.992,7262.231,7264.957,7269.911,7272.634,\
      7274.861,7275.85,7282.774,7284.01,7289.691,7290.679,\
      7296.355,7297.342,7297.835,7299.315,7299.562,7301.781,\
      7305.231,7309.419,7309.665,7315.08,7320.246,7321.475,\
      7323.933,7328.847,7332.039,7337.193,7339.891,7340.872,\
      7342.833,7344.794,7345.774,7346.509,7349.694,7354.59,\
      7356.793,7358.505,7360.462,7367.306,7368.039,7375.12,\
      7380.244,7382.195,7382.682,7383.901,7384.145,7386.582,\
      7389.993,7393.402,7393.646,7394.376,7399.73,7404.35,\
      7406.052,7413.339,7416.01,7421.59,7424.742,7425.712,\
      7427.651,7428.62,7430.559,7430.801,7434.433,7439.274,\
      7440.968,7445.079,7451.845,7452.087,7459.571,7464.154,\
      7467.048,7467.53,7468.253,7468.976,7471.385,7474.758,\
      7477.887,7479.091,7484.384,7488.471,7490.634,7497.84,\
      7500,7505.998,7509.594,7510.553,7512.47,7515.105,\
      7515.344,7519.175,7523.962,7525.158,7529.701,7536.153,\
      7536.392,7544.031,7551.9,7552.377,7552.615,7553.807,\
      7556.19,7559.524,7562.143,7563.809,7569.042,7572.609,\
      7575.223,7582.348,7590.415,7594.445,7595.393,7597.289,\
      7599.421,7600.132,7603.92,7608.653,7609.363,7614.329,\
      7620.945,7628.499,7636.753,7636.989,7637.225,7638.639,\
      7640.995,7644.292,7646.411,7648.529,7653.705,7659.817,\
      7666.864,7674.842,7679.297,7680.234,7682.109,7683.749,\
      7684.92,7688.667,7693.348,7698.961,7705.505,7712.976,\
      7721.373,7721.606,7722.072,7723.471,7725.801,7729.062,\
      7733.253,7738.372,7744.417,7751.387,7759.278,7764.148,\
      7765.076,7766.93,7769.71,7773.416,7778.046,7783.598,\
      7790.071,7797.461,7806.459,7806.92,7808.303,7810.608,\
      7813.834,7817.979,7823.043,7829.023,7835.917,7849,\
      7849.917,7851.751,7854.502,7858.168,7862.748,7868.24,\
      7874.643,7891.312,7891.768,7893.136,7895.416,7898.607,\
      7902.708,7907.718,7913.634,7933.852,7934.759,7936.574,\
      7939.295,7942.921,7947.452,7952.886,7976.164,7976.616,\
      7977.97,7980.226,7983.383,7987.44,7992.396,8018.703,\
      8019.601,8021.396,8024.089,8027.677,8032.16,8061.017,\
      8061.464,8062.803,8065.036,8068.16,8072.174,8103.555,\
      8104.443,8106.22,8108.884,8112.435,8145.87,8146.312,\
      8147.638,8149.847,8152.938,8188.406,8189.286,8191.044,\
      8193.68,8230.723,8231.16,8232.472,8234.658,8273.258,\
      8274.128,8275.869,8315.576,8316.009,8317.307,8358.11,\
      8358.971,8400.429,8400.857,8442.962,8485.281}");
  /*
  dvector gins("{0,60,84.85281,120,134.1641,169.7056,\
      180,189.7367,216.3331,240,247.3863,254.5584,\
      268.3282,300,305.9412,323.1099,339.4113,349.8571,\
      364.9658,384.1875,402.4922,424.2641,436.8066,456.9464,\
      468.615,483.7355,494.7727,516.1395,543.3231,553.1727,\
      569.21,593.9697,602.9925,611.8823,617.7378,626.4184,\
      637.8087,648.9992,662.7217,670.8204,678.8225,684.1053,\
      702.282,732.3933,742.159,751.7978,768.3749,782.3043,\
      789.1768,807.2174,816.0882,842.1401,852.7602,859.0693,\
      865.3323,873.6132,885.8894,891.9641,901.9978,907.9648,\
      917.8235,939.1486,948.6833,961.8732,969.3297,976.7292,\
      984.0732,993.1767,998.599,1005.783,1027.035,1035.761,\
      1049.571,1063.203,1068.27,1073.313,1086.646,1094.897,\
      1106.345,1120.893,1132.078,1146.298,1158.792,1164.989,\
      1207.477,1214.907,1223.765,1236.932,1252.837,1265.701,\
      1275.617,1297.998,1310.42,1332.216,1341.641,1348.332,\
      1360.294,1370.839,1385.208,1405.845,1416.051,1426.184,\
      1431.223,1452.446,1464.787,1475.805,1490.369,1504.792,\
      1519.079,1542.595,1548.419,1564.609,1578.354,1588.584,\
      1601,1624.438,1632.176,1638.78,1673.559,1684.28,\
      1699.176,1707.63,1719.186,1731.704,1756.474,1765.673,\
      1783.928,1789.972,1815.93,1840.543,1853.213,1868.689,\
      1884.038,1897.367,1968.146,1973.626,1988.165,2005.293,\
      2016.928,2024.055,2030.271,2054.069,2072.39,2113.67,\
      2130.634,2136.539,2154.159,2174.948,2184.033,2189.795,\
      2213.504,2232.935,2271.299,2299.652,2309.026,2318.361,\
      2346.913,2367.53,2381.932,2421.652,2431.296,2436.473,\
      2451.204,2489.096,2507.11,2512.847,2532.114,2568.112,\
      2607.758,2624.271,2657.668,2665.108,2689.312,2742.335,\
      2784.026,2812.33,2837.816,2852.367,2889.983,2989.18,\
      3021.523,3048.213,3134.39,3253.859,3289.073,3313.608,\
      3498.571,3580.95,3760.904,3769.032,3804.681,3879.639,\
      3937.207,4036.087,4296.603,4302.046,4312.076,4394.77,\
      4601.652,4651.451,4661.888,4848.505,5510.209,5910.533,\
      6132.928,6208.768,6217.17,6300.286,6400.625,6432.045,\
      6484.721,6507.995,6648.097,6684.819,6691.278,6724.284,\
      6900,6907.3,6926.038,6977.048,6984.01,6990.966,\
      7010.763,7032.041,7061.161,7068.041,7095.492,7107.658,\
      7116.01,7145.796,7180.223,7191.245,7200,7206.247,\
      7230.436,7275.85,7284.01,7290.679,7309.665,7315.08,\
      7332.039,7360.462,7368.039,7375.12,7394.376,7406.052,\
      7416.01,7445.079,7452.087,7479.091,7490.634,7500,\
      7529.701,7536.392,7544.031,7563.809,7575.223,7582.348,\
      7614.329,7620.945,7628.499,7648.529,7653.705,7659.817,\
      7666.864,7693.348,7698.961,7705.505,7712.976,7733.253,\
      7738.372,7744.417,7751.387,7778.046,7783.598,7790.071,\
      7797.461,7817.979,7823.043,7829.023,7835.917,7862.748,\
      7868.24,7874.643,7902.708,7907.718,7913.634,7947.452,\
      7952.886,7992.396,8032.16,8072.174,8112.435,8152.938,\
      8193.68,8234.658,8275.869,8317.307,8358.971,8400.857,\
      8442.962}");
  */
  /*
  dvector gins ("{0.00000,60.00000,84.85281,120.00000,134.16408,169.70563,\
     180.00000,189.73666,216.33308,240.00000,247.38634,254.55844,\
     268.32816,300.00000,305.94117,323.10989,339.41125,349.85711,\
     360.00000,364.96575,379.47332,384.18745,402.49224,420.00000,\
     424.26407,432.66615,436.80659,456.94639,468.61498,480.00000,\
     483.73546,494.77268,509.11688,512.64022,516.13952,536.65631,\
     540.00000,543.32311,553.17267,566.03887,569.20998,590.93147,\
     593.96970,600.00000,602.99254,611.88234,617.73781,626.41839,\
     637.80875,646.21978,648.99923,660.00000,662.72166,670.82039,\
     678.82251,684.10526,699.71423,702.28199,720.00000,722.49567,\
     724.98276,729.93150,732.39334,742.15901,751.79785,758.94664,\
     763.67532,768.37491,780.00000,782.30429,789.17679,800.49984,\
     804.98447,807.21744,816.08823,833.54664,835.70330,840.00000,\
     842.14013,848.52814,852.76022,859.06926,865.33231,873.61319,\
     885.88938,891.96412,900.00000,901.99778,907.96476,913.89277,\
     915.86025,917.82351,931.45048,933.38095,937.22996,939.14855,\
     948.68330,960.00000,961.87317,967.47093,969.32967,976.72924,\
     984.07317,989.54535,993.17672,998.59902,1005.78328,1018.23376,\
    1020.00000,1021.76318,1025.28045,1027.03457,1032.27903,1035.76059,\
    1047.85495,1049.57134,1061.50836,1063.20271,1068.26963,1073.31263,\
    1080.00000,1081.66538,1086.64622,1094.89726,1101.45359,1103.08658,\
    1106.34533,1116.06451,1120.89250,1127.29765,1132.07774,1138.41996,\
    1140.00000,1141.57786,1146.29839,1152.56236,1154.12304,1158.79247,\
    1164.98927,1178.81296,1181.86294,1183.38498,1187.93939,1190.96599,\
    1195.49153,1200.00000,1201.49906,1205.98507,1207.47671,1213.42490,\
    1214.90740,1223.76468,1231.09707,1235.47562,1236.93169,1248.51912,\
    1252.83678,1260.00000,1261.42776,1265.70139,1271.37721,1272.79221,\
    1275.61750,1282.65350,1284.05607,1288.25463,1292.43955,1295.22199,\
    1297.99846,1310.41978,1315.90273,1317.26990,1320.00000,1321.36293,\
    1325.44332,1328.15662,1332.21620,1341.64079,1348.33230,1353.66170,\
    1357.64502,1360.29409,1368.21051,1369.52547,1370.83916,1380.00000,\
    1381.30373,1385.20757,1391.68962,1395.56440,1399.42845,1400.71410,\
    1404.56399,1405.84494,1412.23228,1416.05085,1422.39235,1426.18372,\
    1431.22325,1440.00000,1441.24946,1442.49783,1444.99135,1449.96552,\
    1451.20639,1452.44621,1459.86301,1461.09548,1464.78667,1470.91808,\
    1475.80487,1481.89068,1484.31803,1485.53021,1490.36908,1500.00000,\
    1501.19952,1503.59569,1504.79234,1510.76140,1514.33154,1517.89328,\
    1519.07867,1527.35065,1529.70585,1533.23188,1536.74982,1537.92067,\
    1542.59522,1548.41855,1556.53461,1557.69060,1560.00000,1561.15342,\
    1564.60858,1570.35028,1574.92857,1578.35357,1584.04545,1585.18138,\
    1588.58428,1594.23963,1597.62323,1600.99969,1609.96894,1612.20346,\
    1614.43489,1615.54944,1620.00000,1621.11073,1624.43836,1629.96932,\
    1632.17646,1637.68129,1638.78003,1647.54363,1650.81798,1655.17371,\
    1659.51800,1663.85095,1667.09328,1668.17265,1671.40659,1673.55908,\
    1680.00000,1681.07109,1684.28026,1689.61534,1690.68034,1693.87131,\
    1697.05627,1698.11660,1699.17627,1705.52045,1706.57552,1707.62994,\
    1716.04196,1718.13853,1719.18585,1727.54161,1730.66461,1731.70436,\
    1740.00000,1741.03418,1744.13302,1747.22637,1749.28557,1752.36982,\
    1756.47374,1764.65294,1765.67268,1771.77877,1772.79440,1776.85115,\
    1780.89865,1781.90909,1783.92825,1789.97207,1797.99889,1800.00000,\
    1800.99972,1803.99557,1804.99307,1808.97761,1813.94597,1815.92951,\
    1821.86717,1824.82876,1827.78555,1828.77008,1831.72050,1835.64702,\
    1836.62734,1840.54340,1848.35062,1852.24188,1853.21343,1860.96749,\
    1862.90096,1863.86695,1866.76190,1868.68938,1874.45992,1878.29710,\
    1879.25517,1883.08258,1884.03822,1897.36660,1905.88562,1906.82983,\
    1909.65966,1913.42625,1914.36674,1917.18544,1920.93727,1932.14906,\
    1934.94186,1938.65933,1946.99769,1951.61472,1953.45847,1958.97933,\
    1961.73393,1965.40072,1968.14634,1980.90888,1986.35344,1987.25942,\
    1994.49242,1997.19804,1998.09910,2005.29300,2012.46118,2016.03571,\
    2016.92836,2030.27092,2036.46753,2038.23453,2040.00000,2043.52636,\
    2047.92578,2052.31577,2064.55806,2068.91276,2079.32681,2080.19230,\
    2082.78659,2089.68897,2099.14268,2100.00000,2113.66979,2121.32034,\
    2123.01672,2128.09774,2130.63371,2136.53926,2148.30165,2163.33077,\
    2164.16266,2167.48702,2174.12051,2184.03297,2197.18001,2206.17316,\
    2207.80434,2212.69067,2220.81066,2232.12903,2248.99978,2252.19893,\
    2258.58363,2268.12698,2291.02597,2292.59678,2297.30277,2305.12473,\
    2333.83804,2336.92105,2343.07490,2375.87878,2377.39353,2381.93199,\
    2418.67732,2421.65233,2460.73160,2462.19414,2503.51753,2545.58441\
    2600.0,2700.0,2800.0,2900.0,3000.0,\
    3200.0,3400.0,3600.0,3800.0,4000.0,4200.0,4400.0,4600.0,4800.0,5000.0}");
  */  
  TTRACE(gins.indexmin(),gins.indexmax())
  int d1 = gins.indexmin();
  int d2 = gins.indexmax();
  dvector bins(d1,d2);
  for (int d = d1; d < d2; d++)
  {
    bins(d) = gins(d)+0.5*(gins(d+1)-gins(d));
  }
  bins(d2) = gins(d2);
  int m = param.get_m();
  int n = param.get_n();
  const double dx = param.get_deltax_prn();
  const double dy = param.get_deltay(); 
  for (int i = 0; i <= m; i++)
  {
    double x = i*dx;
    for (int j = 0; j <= n; j++)
    {
      double y = j*dy;
      distances(i,j) = sqrt(x*x+y*y);
    }
  }
  return(bins);
}

void write_displacement_files(const dmatrix& displacement, 
                         dmatrix& xdisp, dmatrix& ydisp, 
                         const dvector& bins,
                         const int fit_number, const char op)
{
  HERE
  //char fit_name[80];
  //ostrstream ss(fit_name,80);
  ostringstream ss;
  ss << "fit" << setw(3) << setfill('0') << hex << fit_number << '_' << op << ends;
  adstring fit_name(ss.str().c_str());
  TTRACE(op,fit_name)
  
  adstring displacement_name = fit_name+adstring("displ.csv");
  TRACE(displacement_name)
  prnstream dfp(displacement_name);
  dfp << endl;
  dfp << "displacement frequencies\n";
  dfp << "months at"  << "net displacement (Nmi) ->" << endl;
  dfp << "liberty";
  int d1 = bins.indexmin();
  int d2 = bins.indexmax();
  int d = 0;
  for (d = d1; d < d2; d+=2)
  {
    //dfp << bins(d)+0.5*(bins(d+1)-bins(d));
    dfp << bins(d+1);
  }
  HERE
  dfp << endl;
  int max_month = displacement.rowmax();
  int month = 0;
  for (month = 0; month <= max_month; month++)
  {
    dfp << month;
    for (d = d1; d < d2; d+=2)
    {
      //dfp << displacement(month,d); 
      dfp << (displacement(month,d)+displacement(month,d+1)); 
    }
    dfp << endl;
  }
  HERE
  dfp.close();

  
  displacement_name = fit_name+adstring("Xdispl.csv");
  TRACE(displacement_name)
  prnstream dfx(displacement_name);
  dfx << "E-W displacement frequencies" << endl;
  dfx << "months at"  << "net displacement (Nmi) ->" << endl;
  dfx << "liberty";
  d1 = xdisp(0).indexmin();
  d2 = xdisp(0).indexmax();
  for (d = d1; d <= d2; d++)
  {
    dfx << (d*60); //delta_x
  }
  dfx << endl;
  max_month = displacement.rowmax();
  for (month = 0; month <= max_month; month++)
  {
    dfx << month;
    for (d = d1; d <= d2; d++)
    {
      dfx << xdisp(month,d); 
    }
    dfx << endl;
  }
  dfx.close();

  displacement_name = fit_name+adstring("Ydispl.csv");
  TRACE(displacement_name)
  prnstream dfy(displacement_name);
  dfy << "N-S displacement frequencies" << endl;
  dfy << "months at"  << "net displacement (Nmi) ->" << endl;
  dfy << "liberty";
  d1 = ydisp(0).indexmin();
  d2 = ydisp(0).indexmax();
  for (d = d1; d <= d2; d++)
  {
    dfy << (d*60); //delta_y
  }
  dfy << endl;
  max_month = displacement.rowmax();
  for (month = 0; month <= max_month; month++)
  {
    dfy << month;
    for (d = d1; d <= d2; d++)
    {
      dfy << ydisp(month,d); 
    }
    dfy << endl;
  }
  dfy.close();
}
